\input{standalone.tex}
\newcommand{\xscale}{0.3}
\newcommand{\yscale}{0.6}
\newcommand{\object}[3]{
	\draw [draw,fill=gray!50] (#1*\xscale,0) rectangle (#2*\xscale+\xscale,\yscale);
	\draw (#1*\xscale*0.5 + #2*\xscale*0.5 + \xscale*0.5,0) node[above=0.05cm]{\Var{#3}};
}
\newcommand{\objectFaded}[3]{
	\draw [draw,fill=gray!25] (#1*\xscale,0) rectangle (#2*\xscale+\xscale,\yscale);
	\draw (#1*\xscale*0.5 + #2*\xscale*0.5 + \xscale*0.5,0) node[above=0.05cm]{\Var{#3}};
}
\newcommand{\pos}[1]{
	\draw [thick,ctcolormain] (#1*\xscale + 0.07*\xscale,0.01) -- 
		(#1*\xscale + 0.07*\xscale,1.5*\yscale) node[right]{\Var{pos}};
}
\newcommand{\target}{
	\draw (40*\xscale,\yscale) node[anchor=south west,ctcoloraccessory]{\Var{target}};
}
\newcommand{\source}{
	\draw (0,\yscale) node[anchor=south east,ctcoloraccessory]{\Var{source}};
}
\newcommand{\border}{
	\draw [very thick] (0,0) rectangle (40*\xscale,\yscale);
	\draw [very thick] (20*\xscale,0) -- (20*\xscale,\yscale);
}
\newcommand{\arrowTop}[2]{
	\draw [->,thick] (#1*\xscale,\yscale) -- (#1*\xscale,\yscale+0.5) 
			-- (#2*\xscale,\yscale+0.5) -- (#2*\xscale,\yscale);
}
\newcommand{\arrowBottom}[2]{
	\draw [->,thick] (#1*\xscale,0) -- (#1*\xscale,-0.5) --
			(#2*\xscale,-0.5) -- (#2*\xscale,0);
}
\newcommand{\arrowBottomLow}[2]{
	\draw [->,thick] (#1*\xscale,0) -- (#1*\xscale,-0.75) --
			(#2*\xscale,-0.75) -- (#2*\xscale,0);
}
\newcommand{\arrowRoots}[1]{
	\draw [->,thick] (#1*\xscale,\yscale + 1) -- (#1*\xscale,\yscale);
}
\newcommand{\todonum}[2]{
	\draw (#1*\xscale+0.3*\xscale,-0.15*\yscale) node[anchor=south east,font=\tiny]{$#2$};
}
\newcommand{\arrowTopHigh}[2]{
	\draw [->,thick] (#1*\xscale,\yscale) -- (#1*\xscale,\yscale+0.75) 
			-- (#2*\xscale,\yscale+0.75) -- (#2*\xscale,\yscale);
}

\begin{document}
	\begin{tikzpicture}	
		\object{0}{1}{a} %2
		\objectFaded{2}{4}{b} %3
		\objectFaded{5}{6}{c} %2
		\object{7}{10}{d} %4
		\objectFaded{11}{13}{e} %3
		\objectFaded{14}{15}{f} %2
		\objectFaded{16}{18}{g} %3
		
		\object{20}{22}{b'}
		\object{23}{24}{f'}
		\object{25}{27}{g'}
		\object{28}{29}{c'}
		\object{30}{32}{e'}
		\todonum{28}{1}
		\todonum{30}{2}
		\todonum{33}{3}
		
		\arrowRoots{21.5}	% R -> b'
		\arrowTop{23.5}{29}		% f' -> c'
		\arrowTop{23.5}{31.5}	% f' -> e'
		\arrowTopHigh{26.5}{15.5}	% g' -> f
		\arrowBottom{9}{1}	% d -> a
		\arrowBottom{21.5}{24}	% b' -> f'
		\arrowBottom{21.5}{26.5}	% b' -> g'
		\pos{33}
		\source
		\target
		\border
		\draw (-\xscale,\yscale/2) node[left]{\textbf{(5)}};
	\end{tikzpicture}
\end{document}